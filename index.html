<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Volpea Web App</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="logo-title">

      <h1>Age & Geo Location</h1>
    </div>
    <div class="theme-toggle">
      <label class="switch">
        <input type="checkbox" id="theme-switch">
        <span class="slider round"></span>
      </label>
    </div>
  </header>

  <main>
    <div class="card">
     <p>Your IP: <span id="ip-address"></span></p>
<p>Your Country: <span id="country-name"></span></p>
<!--  -->


    <!--  -->
<div style="max-width: 600px; margin: auto; text-align: center;">
  <h3>Date of Birth</h3>

  <div style="display: flex; justify-content: space-between; gap: 10px;">
    <div style="flex: 1;">
      <label for="day">Day</label><br>
      <input type="number" id="day" min="1" max="31" required>
    </div>
    <div style="flex: 1;">
      <label for="month">Month</label><br>
      <input type="number" id="month" min="1" max="12" required>
    </div>
    <div style="flex: 1;">
      <label for="year">Year</label><br>
      <input type="number" id="year" min="1900" max="2100" required>
    </div>
  </div>

  <br>
  <button onclick="calculateAge()" style="padding: 8px 20px;">Calculate Age</button>
  <p id="ageResult" style="margin-top: 15px; font-weight: bold;"></p>
</div>


      <p id="age-warning" class="warning"></p>

      <!-- calculates age -->
       
      <label for="country">Select a country:</label>
      <select id="country-select" required>
        <option value="" disabled selected hidden>Choose a country</option>
       
        <option value="US">USA</option>
        <option value="PK">Pakistan</option>
        <option value="IN">India</option>
        <option value="DE">Germany</option>
        <option value="JP">Japan</option>
      </select>
    </div>

    <div class="card" id="country-info">
      <h3>Country Details</h3>
      <img id="flag" src="" alt="Flag" class="flag" />
      <p id="fact">Select a country to see the fact.</p>
    </div>
    <!-- reset button  -->
    <button id="resetBtn">Reset</button>
  </main>
<!--  reset button -->
 


  <footer>
    <p>&copy; 2025 Volpea Solutions | All rights reserved.</p>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
  const ipDisplay = document.getElementById("ip-address");
  const countrySelect = document.getElementById("country-select");
  const flagImg = document.getElementById("flag");
  const factText = document.getElementById("fact");
  const themeSwitch = document.getElementById("theme-switch");

  // : Age prompt on page load
  const age = parseInt(prompt("Please enter your age:"));
  if (isNaN(age)) {
    alert("Invalid input. Please enter a number.");
    window.location.href = "https://example.com/restricted.html"; // Customize this
    return;
  } else if (age < 18) {
    alert("You must be at least 18 years old to continue.");
    window.location.href = "https://example.com/restricted.html"; // or window.close();
    return;
  }

  //  Theme setup
  const savedTheme = localStorage.getItem("theme");
  if (savedTheme === "dark") {
    document.body.classList.add("dark");
    themeSwitch.checked = true;
  }

  themeSwitch.addEventListener("change", () => {
    document.body.classList.toggle("dark");
    localStorage.setItem("theme", document.body.classList.contains("dark") ? "dark" : "light");
  });

  //  Fetch IP
 fetch("https://ipinfo.io/json?token=36ab21b59db96f")
  .then((res) => res.json())
  .then((data) => {
    ipDisplay.textContent = data.ip;

    // Map country code to full name
    const countryNames = {
      PK: "Pakistan",
      US: "USA",
      IN: "India",
      DE: "Germany",
      JP: "Japan"
    };

    const fullCountryName = countryNames[data.country] || data.country;

    document.getElementById("country-name").textContent = fullCountryName;
    countrySelect.value = data.country;
    countrySelect.dispatchEvent(new Event("change"));

    localStorage.setItem("ip", data.ip);
    localStorage.setItem("country", data.country);
  })
  .catch(() => {
    ipDisplay.textContent = "Failed to load IP";
    document.getElementById("country-name").textContent = "Failed to load country";
  });

    

  //  Country & Flag
  const countryFacts = {
    US: "Bald Eagle is the national bird.",
    PK: "Home to the world's second highest mountain, K2.",
    IN: "India is the world's largest democracy.",
    DE: "Germany is known for its engineering and Oktoberfest.",
    JP: "Japan has more than 1500 earthquakes each year."
  };

  countrySelect.addEventListener("change", () => {
    const country = countrySelect.value;
    if (!country) return;

    localStorage.setItem("country", country);

    fetch(`https://restcountries.com/v3.1/alpha/${country}`)
      .then((res) => res.json())
      .then((data) => {
        flagImg.src = data[0].flags.svg;
        flagImg.alt = `${country} Flag`;
        factText.textContent = countryFacts[country] || "Fun fact not available.";
      })
      .catch(() => {
        flagImg.src = "";
        factText.textContent = "Unable to load flag or fact.";
      });
  });

//

  });

  // üîÅ Load stored country
  const storedCountry = localStorage.getItem("country");
  if (storedCountry) {
    countrySelect.value = storedCountry;

    countrySelect.dispatchEvent(new Event("change"));
  }


//reset button
document.getElementById("resetBtn").addEventListener("click", function () {
  // Clear localStorage
  localStorage.clear();

  // Reset dropdown
  document.getElementById("country-select").selectedIndex = 0;

  // Clear text/flags
  document.getElementById("ip-address").textContent = "";
  document.getElementById("country-name").textContent = "";
  document.getElementById("flag").src = "";
  document.getElementById("fact").textContent = "Select a country to see the fact.";
  document.getElementById("age-warning").textContent = "";

  // Reload age prompt
  location.reload();
});


//calculate age
 function calculateAge() {
    const day = parseInt(document.getElementById("day").value);
    const month = parseInt(document.getElementById("month").value);
    const year = parseInt(document.getElementById("year").value);

    if (isNaN(day) || isNaN(month) || isNaN(year)) {
      alert("Please fill all fields with valid numbers.");
      return;
    }

    const birthDate = new Date(year, month - 1, day);
    const today = new Date();

    let age = today.getFullYear() - birthDate.getFullYear();
    const m = today.getMonth() - birthDate.getMonth();
    const d = today.getDate() - birthDate.getDate();

    if (m < 0 || (m === 0 && d < 0)) {
      age--;
    }

    document.getElementById("ageResult").textContent = `Your age is ${age} years.`;
  }
//
  </script>

</body>
</html>
